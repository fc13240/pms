<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.lotut.pms.dao.mapper.PatentDocWorkflowHistoryMapper">
  		<resultMap type="PatentDocWorkflowHistory" id="PatentDocWorkflowHistoryMap">
  			<id property="historyId" column="history_id"/>
  			<result property="patentDocId"  column="patent_doc_id" />
  			<result property="userId"  column="user_id" />
  			<result property="userName"  column="user_name" />
  			<result property="action"  column="ACTION" />
  			<result property="actionTime"  column="action_time" />
  		</resultMap>
  
  	
  	<insert id="insertWorkflowTargets" parameterType="list" >
  		replace into patent_doc_workflow_target(history,target,patent_doc)
  		values
  		<foreach item="patentDocWorkflowTargetRecord" collection="list" separator=",">
			(#{patentDocWorkflowTargetRecord.history},#{patentDocWorkflowTargetRecord.target}, #{patentDocWorkflowTargetRecord.patentDoc})
		</foreach>
  	</insert>
  
	<insert id="insertHistories"  parameterType="list" useGeneratedKeys="true" keyProperty="historyId">
		replace into patent_doc_workflow_history(patent_doc_id,user_id,ACTION,action_time)
		values
		<foreach item="patentDocWorkflowHistoryRecord" collection="list" separator=",">
			(#{patentDocWorkflowHistoryRecord.patentDocId},#{patentDocWorkflowHistoryRecord.userId}, #{patentDocWorkflowHistoryRecord.action},now())
		</foreach>
	</insert>
	
	<select id="getPatentDocWorkflowHistoryByUserAndAction" resultMap="PatentDocWorkflowHistoryMap">
		select history_id,patent_doc_id,user_id,ACTION,action_time patent_doc_workflow_history from  where 
		user_id =(#{userId}) and ACTION= (#{action})
	
	</select>
	
	 </mapper>